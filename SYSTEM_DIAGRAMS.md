# Sakura Dental Clinic - System Architecture Diagrams

## 1. High-Level System Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                    CLIENT LAYER                                 │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  │
│  │   Web Browser   │  │  Mobile App     │  │  Admin Panel    │  │
│  │   (Next.js)     │  │  (React Native) │  │  (React)        │  │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                                │ HTTPS/REST API
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    PRESENTATION LAYER                           │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  │
│  │   Controllers   │  │   Security      │  │   Exception     │  │
│  │   (REST APIs)   │  │   (JWT Auth)    │  │   Handlers      │  │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                                │ Service Calls
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    BUSINESS LOGIC LAYER                         │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  │
│  │   Services      │  │   DTOs          │  │   Utilities     │  │
│  │   (Business     │  │   (Data         │  │   (Helpers)     │  │
│  │    Logic)       │  │    Transfer)    │  │                 │  │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                                │ Repository Calls
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    DATA ACCESS LAYER                            │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  │
│  │  Repositories   │  │   Models        │  │   Hibernate     │  │
│  │   (Data Access) │  │   (Entities)    │  │   (ORM)         │  │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                │
                                │ JDBC
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    DATA STORAGE LAYER                           │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  │
│  │   MySQL 8.0     │  │   File Storage  │  │   Cache         │  │
│  │   (Primary DB)  │  │   (Documents)   │  │   (Redis)       │  │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

## 2. Database Schema Overview

```
┌─────────────────────────────────────────────────────────────────┐
│                        SAKURA DATABASE                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │   USERS     │    │   ROLES     │    │PERMISSIONS  │         │
│  │             │    │             │    │             │         │
│  │ • user_id   │    │ • role_id   │    │ • perm_id   │         │
│  │ • username  │    │ • name      │    │ • name      │         │
│  │ • password  │    │ • desc      │    │ • desc      │         │
│  │ • email     │    │ • status    │    │ • status    │         │
│  │ • role_id   │    └─────────────┘    └─────────────┘         │
│  │ • employee  │            ▲                    ▲              │
│  │ • status    │            │                    │              │
│  └─────────────┘            │                    │              │
│         │                   │                    │              │
│         │ 1:1               │                    │              │
│         ▼                   │                    │              │
│  ┌─────────────┐            │                    │              │
│  │ EMPLOYEES   │            │                    │              │
│  │             │            │                    │              │
│  │ • emp_id    │            │                    │              │
│  │ • first_name│            │                    │              │
│  │ • last_name │            │                    │              │
│  │ • job_title │            │                    │              │
│  │ • hire_date │            │                    │              │
│  │ • status    │            │                    │              │
│  └─────────────┘            │                    │              │
│         │                   │                    │              │
│         │ N:1               │                    │              │
│         ▼                   │                    │              │
│  ┌─────────────┐            │                    │              │
│  │JOB_TITLES   │            │                    │              │
│  │             │            │                    │              │
│  │ • title_id  │            │                    │              │
│  │ • name      │            │                    │              │
│  │ • desc      │            │                    │              │
│  │ • status    │            │                    │              │
│  └─────────────┘            │                    │              │
│                             │                    │              │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │  PATIENTS   │    │DOC_TYPES    │    │  GENDERS    │         │
│  │             │    │             │    │             │         │
│  │ • pat_id    │    │ • type_id   │    │ • gender_id │         │
│  │ • first_name│    │ • name      │    │ • name      │         │
│  │ • last_name │    │ • desc      │    │ • desc      │         │
│  │ • dni       │    │ • status    │    │ • status    │         │
│  │ • birth_date│    └─────────────┘    └─────────────┘         │
│  │ • doc_type  │            ▲                    ▲              │
│  │ • gender    │            │                    │              │
│  │ • district  │            │                    │              │
│  │ • phone     │            │                    │              │
│  │ • email     │            │                    │              │
│  │ • status    │            │                    │              │
│  └─────────────┘            │                    │              │
│         │                   │                    │              │
│         │ N:1               │                    │              │
│         ▼                   │                    │              │
│  ┌─────────────┐            │                    │              │
│  │ DISTRICTS   │            │                    │              │
│  │             │            │                    │              │
│  │ • dist_id   │            │                    │              │
│  │ • name      │            │                    │              │
│  │ • desc      │            │                    │              │
│  │ • status    │            │                    │              │
│  └─────────────┘            │                    │              │
│                             │                    │              │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │  SERVICES   │    │CATEGORIES   │    │CLINICAL_HIST│         │
│  │             │    │             │    │             │         │
│  │ • serv_id   │    │ • cat_id    │    │ • hist_id   │         │
│  │ • name      │    │ • name      │    │ • patient   │         │
│  │ • desc      │    │ • desc      │    │ • diagnosis │         │
│  │ • price     │    │ • status    │    │ • treatment │         │
│  │ • category  │    └─────────────┘    │ • notes     │         │
│  │ • status    │            ▲          │ • created   │         │
│  └─────────────┘            │          └─────────────┘         │
│         │                   │                    ▲              │
│         │ N:1               │                    │              │
│         └───────────────────┘                    │              │
│                                                  │              │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │ QUOTATIONS  │    │QUOT_ITEMS   │    │  PAYMENTS   │         │
│  │             │    │             │    │             │         │
│  │ • quot_id   │    │ • item_id   │    │ • pay_id    │         │
│  │ • patient   │    │ • quotation │    │ • quotation │         │
│  │ • history   │    │ • service   │    │ • method    │         │
│  │ • total     │    │ • quantity  │    │ • amount    │         │
│  │ • status    │    │ • unit_price│    │ • balance   │         │
│  │ • created   │    │ • subtotal  │    │ • date      │         │
│  └─────────────┘    └─────────────┘    │ • status    │         │
│         │                   ▲          │ • created_by│         │
│         │ 1:N               │          │ • canceled  │         │
│         └───────────────────┘          └─────────────┘         │
│                                                  │              │
│                                                  │ N:1          │
│                                                  ▼              │
│                                          ┌─────────────┐         │
│                                          │PAY_METHODS  │         │
│                                          │             │         │
│                                          │ • method_id │         │
│                                          │ • name      │         │
│                                          │ • desc      │         │
│                                          └─────────────┘         │
└─────────────────────────────────────────────────────────────────┘
```

## 3. Business Process Flow

### Patient Registration Flow
```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   START     │───▶│  VALIDATE   │───▶│  CHECK      │───▶│   CREATE    │
│             │    │   INPUT     │    │  DUPLICATE  │    │   PATIENT   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                                              │
                                                              ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   END       │◀───│  GENERATE   │◀───│  CREATE     │◀───│   RETURN    │
│             │    │  CLINICAL   │    │  HISTORY    │    │   PATIENT   │
│             │    │  HISTORY    │    │             │    │     ID      │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### Quotation Creation Flow
```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  SELECT     │───▶│  CHOOSE     │───▶│ CALCULATE   │───▶│  APPLY      │
│  PATIENT    │    │  SERVICES   │    │   TOTAL     │    │ DISCOUNTS   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                                              │
                                                              ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   END       │◀───│  TRACK      │◀───│   SEND      │◀───│  GENERATE   │
│             │    │  STATUS     │    │  TO PATIENT │    │ QUOTATION   │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

### Payment Processing Flow
```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  PATIENT    │───▶│  SELECT     │───▶│  PROCESS    │───▶│   UPDATE    │
│  ACCEPTS    │    │  PAYMENT    │    │  PAYMENT    │    │  BALANCE    │
│ QUOTATION   │    │  METHOD     │    │             │    │             │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                                              │
                                                              ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   END       │◀───│  SCHEDULE   │◀───│   UPDATE    │◀───│  GENERATE   │
│             │    │ TREATMENT   │    │ QUOTATION   │    │  RECEIPT    │
│             │    │             │    │   STATUS    │    │             │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

## 4. Security Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                        SECURITY LAYER                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │   CLIENT    │    │   NETWORK   │    │ APPLICATION │         │
│  │  SECURITY   │    │  SECURITY   │    │  SECURITY   │         │
│  │             │    │             │    │             │         │
│  │ • HTTPS     │    │ • Firewall  │    │ • JWT Auth  │         │
│  │ • CORS      │    │ • VPN       │    │ • RBAC      │         │
│  │ • CSP       │    │ • SSL/TLS   │    │ • Input Val │         │
│  │ • XSS Prot  │    │ • Rate Lim  │    │ • SQL Inj   │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│         │                   │                   │              │
│         └───────────────────┼───────────────────┘              │
│                             │                                  │
│                             ▼                                  │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │   DATA      │    │   ACCESS    │    │   AUDIT     │         │
│  │  SECURITY   │    │  CONTROL    │    │   LOGGING   │         │
│  │             │    │             │    │             │         │
│  │ • Encryption│    │ • Roles     │    │ • Login Log │         │
│  │ • Backup    │    │ • Perms     │    │ • Action Log│         │
│  │ • Recovery  │    │ • Sessions  │    │ • Error Log │         │
│  │ • Integrity │    │ • Timeout   │    │ • Security  │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
└─────────────────────────────────────────────────────────────────┘
```

## 5. API Endpoint Structure

```
┌─────────────────────────────────────────────────────────────────┐
│                        API ENDPOINTS                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │   AUTH      │    │   PATIENTS  │    │  SERVICES   │         │
│  │             │    │             │    │             │         │
│  │ POST /auth  │    │ GET /patients│   │ GET /services│        │
│  │ POST /login │    │ POST /patients│  │ POST /services│       │
│  │ POST /logout│    │ PUT /patients│   │ PUT /services│        │
│  │ GET /profile│    │ DEL /patients│   │ DEL /services│        │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │ QUOTATIONS  │    │  PAYMENTS   │    │   USERS     │         │
│  │             │    │             │    │             │         │
│  │ GET /quotes │    │ GET /payments│   │ GET /users  │         │
│  │ POST /quotes│    │ POST /payments│  │ POST /users │         │
│  │ PUT /quotes │    │ PUT /payments│   │ PUT /users  │         │
│  │ DEL /quotes │    │ DEL /payments│   │ DEL /users  │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │   REPORTS   │    │   CONFIG    │    │   HEALTH    │         │
│  │             │    │             │    │             │         │
│  │ GET /reports│    │ GET /config │    │ GET /health │         │
│  │ POST /reports│   │ PUT /config │    │ GET /metrics│         │
│  │ GET /export │    │ GET /backup │    │ GET /status │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
└─────────────────────────────────────────────────────────────────┘
```

## 6. Deployment Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                        PRODUCTION ENVIRONMENT                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │   LOAD      │    │   WEB       │    │  DATABASE   │         │
│  │ BALANCER    │    │  SERVER     │    │   CLUSTER   │         │
│  │             │    │             │    │             │         │
│  │ • Nginx     │    │ • Spring    │    │ • MySQL     │         │
│  │ • SSL Term  │    │   Boot      │    │   Primary   │         │
│  │ • Rate Lim  │    │ • JVM       │    │ • MySQL     │         │
│  │ • Caching   │    │ • Tomcat    │    │   Replica   │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│         │                   │                   │              │
│         └───────────────────┼───────────────────┘              │
│                             │                                  │
│                             ▼                                  │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │   CACHE     │    │   STORAGE   │    │   MONITOR   │         │
│  │   LAYER     │    │   LAYER     │    │   LAYER     │         │
│  │             │    │             │    │             │         │
│  │ • Redis     │    │ • File      │    │ • Prometheus│         │
│  │ • Session   │    │   Storage   │    │ • Grafana   │         │
│  │ • Cache     │    │ • Backups   │    │ • Logs      │         │
│  │ • Queue     │    │ • Logs      │    │ • Alerts    │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
└─────────────────────────────────────────────────────────────────┘
```

## 7. Data Flow Diagram

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   CLIENT    │───▶│   API       │───▶│  SERVICE    │───▶│ REPOSITORY  │
│             │    │  GATEWAY    │    │   LAYER     │    │   LAYER     │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
       ▲                   │                   │                   │
       │                   ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   RESPONSE  │◀───│   VALIDATE  │◀───│  BUSINESS   │◀───│   DATABASE  │
│             │    │   & AUTH    │    │   LOGIC     │    │             │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

## 8. Technology Stack

```
┌─────────────────────────────────────────────────────────────────┐
│                        TECHNOLOGY STACK                         │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │  FRONTEND   │    │  BACKEND    │    │  DATABASE   │         │
│  │             │    │             │    │             │         │
│  │ • Next.js   │    │ • Spring    │    │ • MySQL 8.0 │         │
│  │ • React     │    │   Boot 3.x  │    │ • Hibernate │         │
│  │ • TypeScript│    │ • Java 17   │    │ • JPA       │         │
│  │ • Tailwind  │    │ • Maven     │    │ • JDBC      │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │  SECURITY   │    │   TOOLS     │    │  INFRA      │         │
│  │             │    │             │    │             │         │
│  │ • JWT       │    │ • Git       │    │ • Docker    │         │
│  │ • BCrypt    │    │ • Maven     │    │ • Nginx     │         │
│  │ • Spring    │    │ • IDE       │    │ • Linux     │         │
│  │   Security  │    │ • Postman   │    │ • Cloud     │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
└─────────────────────────────────────────────────────────────────┘
``` 